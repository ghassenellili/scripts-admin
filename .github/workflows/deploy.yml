name: DÃ©ploiement Automatique

on:
  push:
    branches: [ main ]
    tags:
      - 'v*'  # Se dÃ©clenche sur les tags version (v1.0, v2.0, etc.)

jobs:
  deploy:
    name: DÃ©ployer les scripts
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'  # Seulement sur main
    
    steps:
      - uses: actions/checkout@v3
      
      - name: PrÃ©parer le package
        run: |
          echo "ğŸ“¦ PrÃ©paration du package..."
          mkdir -p release
          cp *.sh release/
          cp README.md release/
          tar -czf scripts-admin-$(date +%Y%m%d).tar.gz release/
          ls -lh *.tar.gz
      
      - name: CrÃ©er une release
        run: |
          echo "ğŸš€ Package prÃªt pour dÃ©ploiement"
          echo "Version : $(date +%Y.%m.%d)"
      
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: scripts-admin-release
          path: scripts-admin-*.tar.gz
          retention-days: 30
